---
# Smart Librarian Export (v2.0)
- Page Number: 51
- Timestamp: 2025-12-11T15:43:20.114410+02:00
- Source URL: https://docs.astral.sh/uv/guides/integration/pytorch
- Page Title: Using uv with PyTorch | uv
- Semantic Filename: using_uv_with_pytorch_uv.md
- Ollama Model: llama3.2:3b
- Export Mode: Smart Deep Crawl
- Statistics:
  - Status: Success
  - Content Length: 32,135 characters
---

# Using uv with PyTorch | uv

[ Skip to content ](https://docs.astral.sh/uv/guides/integration/pytorch/#using-uv-with-pytorch)
# [Using uv with PyTorch](https://docs.astral.sh/uv/guides/integration/pytorch/#using-uv-with-pytorch)
The 
Note
Some of the features outlined in this guide require uv version 0.5.3 or later. We recommend upgrading prior to configuring PyTorch.
## [Installing PyTorch](https://docs.astral.sh/uv/guides/integration/pytorch/#installing-pytorch)
From a packaging perspective, PyTorch has a few uncommon characteristics:
  * Many PyTorch wheels are hosted on a dedicated index, rather than the Python Package Index (PyPI). As such, installing PyTorch often requires configuring a project to use the PyTorch index.
  * PyTorch produces distinct builds for each accelerator (e.g., CPU-only, CUDA). Since there's no standardized mechanism for specifying these accelerators when publishing or installing, PyTorch encodes them in the local version specifier. As such, PyTorch versions will often look like `2.5.1+cpu`, `2.5.1+cu121`, etc.
  * Builds for different accelerators are published to different indexes. For example, the `+cpu` builds are published on `+cu121` builds are published on 


As such, the necessary packaging configuration will vary depending on both the platforms you need to support and the accelerators you want to enable.
To start, consider the following (default) configuration, which would be generated by running `uv init --python 3.14` followed by `uv add torch torchvision`.
In this case, PyTorch would be installed from PyPI, which hosts CPU-only wheels for Windows and macOS, and GPU-accelerated wheels on Linux (targeting CUDA 12.8, as of PyTorch 2.9.1):
```
[](https://docs.astral.sh/uv/guides/integration/pytorch/#__codelineno-0-1)[project]
[](https://docs.astral.sh/uv/guides/integration/pytorch/#__codelineno-0-2)name="project"
[](https://docs.astral.sh/uv/guides/integration/pytorch/#__codelineno-0-3)version="0.1.0"
[](https://docs.astral.sh/uv/guides/integration/pytorch/#__codelineno-0-4)requires-python=">=3.14"
[](https://docs.astral.sh/uv/guides/integration/pytorch/#__codelineno-0-5)dependencies=[
[](https://docs.astral.sh/uv/guides/integration/pytorch/#__codelineno-0-6)"torch>=2.9.1",
[](https://docs.astral.sh/uv/guides/integration/pytorch/#__codelineno-0-7)"torchvision>=0.24.1",
[](https://docs.astral.sh/uv/guides/integration/pytorch/#__codelineno-0-8)]

```

This is a valid configuration for projects that want to use CPU builds on Windows and macOS, and CUDA-enabled builds on Linux. However, if you need to support different platforms or accelerators, you'll need to configure the project accordingly.
## [Using a PyTorch index](https://docs.astral.sh/uv/guides/integration/pytorch/#using-a-pytorch-index)
In some cases, you may want to use a specific PyTorch variant across all platforms. For example, you may want to use the CPU-only builds on Linux too.
In such cases, the first step is to add the relevant PyTorch index to your `pyproject.toml`:
[CPU-only](https://docs.astral.sh/uv/guides/integration/pytorch/#__tabbed_1_1)[CUDA 11.8](https://docs.astral.sh/uv/guides/integration/pytorch/#__tabbed_1_2)[CUDA 12.6](https://docs.astral.sh/uv/guides/integration/pytorch/#__tabbed_1_3)[CUDA 12.8](https://docs.astral.sh/uv/guides/integration/pytorch/#__tabbed_1_4)[CUDA 13.0](https://docs.astral.sh/uv/guides/integration/pytorch/#__tabbed_1_5)[ROCm6](https://docs.astral.sh/uv/guides/integration/pytorch/#__tabbed_1_6)[Intel GPUs](https://docs.astral.sh/uv/guides/integration/pytorch/#__tabbed_1_7)
```
[](https://docs.astral.sh/uv/guides/integration/pytorch/#__codelineno-1-1)[[tool.uv.index]]
[](https://docs.astral.sh/uv/guides/integration/pytorch/#__codelineno-1-2)name="pytorch-cpu"
[](https://docs.astral.sh/uv/guides/integration/pytorch/#__codelineno-1-3)url="https://download.pytorch.org/whl/cpu"
[](https://docs.astral.sh/uv/guides/integration/pytorch/#__codelineno-1-4)explicit=true

```

```
[](https://docs.astral.sh/uv/guides/integration/pytorch/#__codelineno-2-1)[[tool.uv.index]]
[](https://docs.astral.sh/uv/guides/integration/pytorch/#__codelineno-2-2)name="pytorch-cu118"
[](https://docs.astral.sh/uv/guides/integration/pytorch/#__codelineno-2-3)url="https://download.pytorch.org/whl/cu118"
[](https://docs.astral.sh/uv/guides/integration/pytorch/#__codelineno-2-4)explicit=true

```

```
[](https://docs.astral.sh/uv/guides/integration/pytorch/#__codelineno-3-1)[[tool.uv.index]]
[](https://docs.astral.sh/uv/guides/integration/pytorch/#__codelineno-3-2)name="pytorch-cu126"
[](https://docs.astral.sh/uv/guides/integration/pytorch/#__codelineno-3-3)url="https://download.pytorch.org/whl/cu126"
[](https://docs.astral.sh/uv/guides/integration/pytorch/#__codelineno-3-4)explicit=true

```

```
[](https://docs.astral.sh/uv/guides/integration/pytorch/#__codelineno-4-1)[[tool.uv.index]]
[](https://docs.astral.sh/uv/guides/integration/pytorch/#__codelineno-4-2)name="pytorch-cu128"
[](https://docs.astral.sh/uv/guides/integration/pytorch/#__codelineno-4-3)url="https://download.pytorch.org/whl/cu128"
[](https://docs.astral.sh/uv/guides/integration/pytorch/#__codelineno-4-4)explicit=true

```

```
[](https://docs.astral.sh/uv/guides/integration/pytorch/#__codelineno-5-1)[[tool.uv.index]]
[](https://docs.astral.sh/uv/guides/integration/pytorch/#__codelineno-5-2)name="pytorch-cu130"
[](https://docs.astral.sh/uv/guides/integration/pytorch/#__codelineno-5-3)url="https://download.pytorch.org/whl/cu130"
[](https://docs.astral.sh/uv/guides/integration/pytorch/#__codelineno-5-4)explicit=true

```

```
[](https://docs.astral.sh/uv/guides/integration/pytorch/#__codelineno-6-1)[[tool.uv.index]]
[](https://docs.astral.sh/uv/guides/integration/pytorch/#__codelineno-6-2)name="pytorch-rocm"
[](https://docs.astral.sh/uv/guides/integration/pytorch/#__codelineno-6-3)url="https://download.pytorch.org/whl/rocm6.4"
[](https://docs.astral.sh/uv/guides/integration/pytorch/#__codelineno-6-4)explicit=true

```

```
[](https://docs.astral.sh/uv/guides/integration/pytorch/#__codelineno-7-1)[[tool.uv.index]]
[](https://docs.astral.sh/uv/guides/integration/pytorch/#__codelineno-7-2)name="pytorch-xpu"
[](https://docs.astral.sh/uv/guides/integration/pytorch/#__codelineno-7-3)url="https://download.pytorch.org/whl/xpu"
[](https://docs.astral.sh/uv/guides/integration/pytorch/#__codelineno-7-4)explicit=true

```

We recommend the use of `explicit = true` to ensure that the index is _only_ used for `torch`, `torchvision`, and other PyTorch-related packages, as opposed to generic dependencies like `jinja2`, which should continue to be sourced from the default index (PyPI).
Next, update the `pyproject.toml` to point `torch` and `torchvision` to the desired index:
[CPU-only](https://docs.astral.sh/uv/guides/integration/pytorch/#__tabbed_2_1)[CUDA 11.8](https://docs.astral.sh/uv/guides/integration/pytorch/#__tabbed_2_2)[CUDA 12.6](https://docs.astral.sh/uv/guides/integration/pytorch/#__tabbed_2_3)[CUDA 12.8](https://docs.astral.sh/uv/guides/integration/pytorch/#__tabbed_2_4)[CUDA 13.0](https://docs.astral.sh/uv/guides/integration/pytorch/#__tabbed_2_5)[ROCm6](https://docs.astral.sh/uv/guides/integration/pytorch/#__tabbed_2_6)[Intel GPUs](https://docs.astral.sh/uv/guides/integration/pytorch/#__tabbed_2_7)
```
[](https://docs.astral.sh/uv/guides/integration/pytorch/#__codelineno-8-1)[tool.uv.sources]
[](https://docs.astral.sh/uv/guides/integration/pytorch/#__codelineno-8-2)torch=[
[](https://docs.astral.sh/uv/guides/integration/pytorch/#__codelineno-8-3){index="pytorch-cpu"},
[](https://docs.astral.sh/uv/guides/integration/pytorch/#__codelineno-8-4)]
[](https://docs.astral.sh/uv/guides/integration/pytorch/#__codelineno-8-5)torchvision=[
[](https://docs.astral.sh/uv/guides/integration/pytorch/#__codelineno-8-6){index="pytorch-cpu"},
[](https://docs.astral.sh/uv/guides/integration/pytorch/#__codelineno-8-7)]

```

PyTorch doesn't publish CUDA builds for macOS. As such, we gate on `sys_platform` to instruct uv to use the PyTorch index on Linux and Windows, but fall back to PyPI on macOS:
```
[](https://docs.astral.sh/uv/guides/integration/pytorch/#__codelineno-9-1)[tool.uv.sources]
[](https://docs.astral.sh/uv/guides/integration/pytorch/#__codelineno-9-2)torch=[
[](https://docs.astral.sh/uv/guides/integration/pytorch/#__codelineno-9-3){index="pytorch-cu118",marker="sys_platform == 'linux' or sys_platform == 'win32'"},
[](https://docs.astral.sh/uv/guides/integration/pytorch/#__codelineno-9-4)]
[](https://docs.astral.sh/uv/guides/integration/pytorch/#__codelineno-9-5)torchvision=[
[](https://docs.astral.sh/uv/guides/integration/pytorch/#__codelineno-9-6){index="pytorch-cu118",marker="sys_platform == 'linux' or sys_platform == 'win32'"},
[](https://docs.astral.sh/uv/guides/integration/pytorch/#__codelineno-9-7)]

```

PyTorch doesn't publish CUDA builds for macOS. As such, we gate on `sys_platform` to instruct uv to limit the PyTorch index to Linux and Windows, falling back to PyPI on macOS:
```
[](https://docs.astral.sh/uv/guides/integration/pytorch/#__codelineno-10-1)[tool.uv.sources]
[](https://docs.astral.sh/uv/guides/integration/pytorch/#__codelineno-10-2)torch=[
[](https://docs.astral.sh/uv/guides/integration/pytorch/#__codelineno-10-3){index="pytorch-cu126",marker="sys_platform == 'linux' or sys_platform == 'win32'"},
[](https://docs.astral.sh/uv/guides/integration/pytorch/#__codelineno-10-4)]
[](https://docs.astral.sh/uv/guides/integration/pytorch/#__codelineno-10-5)torchvision=[
[](https://docs.astral.sh/uv/guides/integration/pytorch/#__codelineno-10-6){index="pytorch-cu126",marker="sys_platform == 'linux' or sys_platform == 'win32'"},
[](https://docs.astral.sh/uv/guides/integration/pytorch/#__codelineno-10-7)]

```

PyTorch doesn't publish CUDA builds for macOS. As such, we gate on `sys_platform` to instruct uv to limit the PyTorch index to Linux and Windows, falling back to PyPI on macOS:
```
[](https://docs.astral.sh/uv/guides/integration/pytorch/#__codelineno-11-1)[tool.uv.sources]
[](https://docs.astral.sh/uv/guides/integration/pytorch/#__codelineno-11-2)torch=[
[](https://docs.astral.sh/uv/guides/integration/pytorch/#__codelineno-11-3){index="pytorch-cu128",marker="sys_platform == 'linux' or sys_platform == 'win32'"},
[](https://docs.astral.sh/uv/guides/integration/pytorch/#__codelineno-11-4)]
[](https://docs.astral.sh/uv/guides/integration/pytorch/#__codelineno-11-5)torchvision=[
[](https://docs.astral.sh/uv/guides/integration/pytorch/#__codelineno-11-6){index="pytorch-cu128",marker="sys_platform == 'linux' or sys_platform == 'win32'"},
[](https://docs.astral.sh/uv/guides/integration/pytorch/#__codelineno-11-7)]

```

PyTorch doesn't publish CUDA builds for macOS. As such, we gate on `sys_platform` to instruct uv to limit the PyTorch index to Linux and Windows, falling back to PyPI on macOS:
```
[](https://docs.astral.sh/uv/guides/integration/pytorch/#__codelineno-12-1)[tool.uv.sources]
[](https://docs.astral.sh/uv/guides/integration/pytorch/#__codelineno-12-2)torch=[
[](https://docs.astral.sh/uv/guides/integration/pytorch/#__codelineno-12-3){index="pytorch-cu130",marker="sys_platform == 'linux' or sys_platform == 'win32'"},
[](https://docs.astral.sh/uv/guides/integration/pytorch/#__codelineno-12-4)]
[](https://docs.astral.sh/uv/guides/integration/pytorch/#__codelineno-12-5)torchvision=[
[](https://docs.astral.sh/uv/guides/integration/pytorch/#__codelineno-12-6){index="pytorch-cu130",marker="sys_platform == 'linux' or sys_platform == 'win32'"},
[](https://docs.astral.sh/uv/guides/integration/pytorch/#__codelineno-12-7)]

```

PyTorch doesn't publish ROCm6 builds for macOS or Windows. As such, we gate on `sys_platform` to instruct uv to limit the PyTorch index to Linux, falling back to PyPI on macOS and Windows:
```
[](https://docs.astral.sh/uv/guides/integration/pytorch/#__codelineno-13-1)[tool.uv.sources]
[](https://docs.astral.sh/uv/guides/integration/pytorch/#__codelineno-13-2)torch=[
[](https://docs.astral.sh/uv/guides/integration/pytorch/#__codelineno-13-3){index="pytorch-rocm",marker="sys_platform == 'linux'"},
[](https://docs.astral.sh/uv/guides/integration/pytorch/#__codelineno-13-4)]
[](https://docs.astral.sh/uv/guides/integration/pytorch/#__codelineno-13-5)torchvision=[
[](https://docs.astral.sh/uv/guides/integration/pytorch/#__codelineno-13-6){index="pytorch-rocm",marker="sys_platform == 'linux'"},
[](https://docs.astral.sh/uv/guides/integration/pytorch/#__codelineno-13-7)]
[](https://docs.astral.sh/uv/guides/integration/pytorch/#__codelineno-13-8)# ROCm6 support relies on `pytorch-triton-rocm`, which should also be installed from the PyTorch index
[](https://docs.astral.sh/uv/guides/integration/pytorch/#__codelineno-13-9)# (and included in `project.dependencies`).
[](https://docs.astral.sh/uv/guides/integration/pytorch/#__codelineno-13-10)pytorch-triton-rocm=[
[](https://docs.astral.sh/uv/guides/integration/pytorch/#__codelineno-13-11){index="pytorch-rocm",marker="sys_platform == 'linux'"},
[](https://docs.astral.sh/uv/guides/integration/pytorch/#__codelineno-13-12)]

```

PyTorch doesn't publish Intel GPU builds for macOS. As such, we gate on `sys_platform` to instruct uv to limit the PyTorch index to Linux and Windows, falling back to PyPI on macOS:
```
[](https://docs.astral.sh/uv/guides/integration/pytorch/#__codelineno-14-1)[tool.uv.sources]
[](https://docs.astral.sh/uv/guides/integration/pytorch/#__codelineno-14-2)torch=[
[](https://docs.astral.sh/uv/guides/integration/pytorch/#__codelineno-14-3){index="pytorch-xpu",marker="sys_platform == 'linux' or sys_platform == 'win32'"},
[](https://docs.astral.sh/uv/guides/integration/pytorch/#__codelineno-14-4)]
[](https://docs.astral.sh/uv/guides/integration/pytorch/#__codelineno-14-5)torchvision=[
[](https://docs.astral.sh/uv/guides/integration/pytorch/#__codelineno-14-6){index="pytorch-xpu",marker="sys_platform == 'linux' or sys_platform == 'win32'"},
[](https://docs.astral.sh/uv/guides/integration/pytorch/#__codelineno-14-7)]
[](https://docs.astral.sh/uv/guides/integration/pytorch/#__codelineno-14-8)# Intel GPU support relies on `pytorch-triton-xpu`, which should also be installed from the PyTorch index
[](https://docs.astral.sh/uv/guides/integration/pytorch/#__codelineno-14-9)# (and included in `project.dependencies`).
[](https://docs.astral.sh/uv/guides/integration/pytorch/#__codelineno-14-10)pytorch-triton-xpu=[
[](https://docs.astral.sh/uv/guides/integration/pytorch/#__codelineno-14-11){index="pytorch-xpu",marker="sys_platform == 'linux' or sys_platform == 'win32'"},
[](https://docs.astral.sh/uv/guides/integration/pytorch/#__codelineno-14-12)]

```

As a complete example, the following project would use PyTorch's CPU-only builds on all platforms:
```
[](https://docs.astral.sh/uv/guides/integration/pytorch/#__codelineno-15-1)[project]
[](https://docs.astral.sh/uv/guides/integration/pytorch/#__codelineno-15-2)name="project"
[](https://docs.astral.sh/uv/guides/integration/pytorch/#__codelineno-15-3)version="0.1.0"
[](https://docs.astral.sh/uv/guides/integration/pytorch/#__codelineno-15-4)requires-python=">=3.14.0"
[](https://docs.astral.sh/uv/guides/integration/pytorch/#__codelineno-15-5)dependencies=[
[](https://docs.astral.sh/uv/guides/integration/pytorch/#__codelineno-15-6)"torch>=2.9.1",
[](https://docs.astral.sh/uv/guides/integration/pytorch/#__codelineno-15-7)"torchvision>=0.24.1",
[](https://docs.astral.sh/uv/guides/integration/pytorch/#__codelineno-15-8)]
[](https://docs.astral.sh/uv/guides/integration/pytorch/#__codelineno-15-9)
[](https://docs.astral.sh/uv/guides/integration/pytorch/#__codelineno-15-10)[tool.uv.sources]
[](https://docs.astral.sh/uv/guides/integration/pytorch/#__codelineno-15-11)torch=[
[](https://docs.astral.sh/uv/guides/integration/pytorch/#__codelineno-15-12){index="pytorch-cpu"},
[](https://docs.astral.sh/uv/guides/integration/pytorch/#__codelineno-15-13)]
[](https://docs.astral.sh/uv/guides/integration/pytorch/#__codelineno-15-14)torchvision=[
[](https://docs.astral.sh/uv/guides/integration/pytorch/#__codelineno-15-15){index="pytorch-cpu"},
[](https://docs.astral.sh/uv/guides/integration/pytorch/#__codelineno-15-16)]
[](https://docs.astral.sh/uv/guides/integration/pytorch/#__codelineno-15-17)
[](https://docs.astral.sh/uv/guides/integration/pytorch/#__codelineno-15-18)[[tool.uv.index]]
[](https://docs.astral.sh/uv/guides/integration/pytorch/#__codelineno-15-19)name="pytorch-cpu"
[](https://docs.astral.sh/uv/guides/integration/pytorch/#__codelineno-15-20)url="https://download.pytorch.org/whl/cpu"
[](https://docs.astral.sh/uv/guides/integration/pytorch/#__codelineno-15-21)explicit=true

```

## [Configuring accelerators with environment markers](https://docs.astral.sh/uv/guides/integration/pytorch/#configuring-accelerators-with-environment-markers)
In some cases, you may want to use CPU-only builds in one environment (e.g., macOS and Windows), and CUDA-enabled builds in another (e.g., Linux).
With `tool.uv.sources`, you can use environment markers to specify the desired index for each platform. For example, the following configuration would use PyTorch's CUDA-enabled builds on Linux, and CPU-only builds on all other platforms (e.g., macOS and Windows):
```
[](https://docs.astral.sh/uv/guides/integration/pytorch/#__codelineno-16-1)[project]
[](https://docs.astral.sh/uv/guides/integration/pytorch/#__codelineno-16-2)name="project"
[](https://docs.astral.sh/uv/guides/integration/pytorch/#__codelineno-16-3)version="0.1.0"
[](https://docs.astral.sh/uv/guides/integration/pytorch/#__codelineno-16-4)requires-python=">=3.14.0"
[](https://docs.astral.sh/uv/guides/integration/pytorch/#__codelineno-16-5)dependencies=[
[](https://docs.astral.sh/uv/guides/integration/pytorch/#__codelineno-16-6)"torch>=2.9.1",
[](https://docs.astral.sh/uv/guides/integration/pytorch/#__codelineno-16-7)"torchvision>=0.24.1",
[](https://docs.astral.sh/uv/guides/integration/pytorch/#__codelineno-16-8)]
[](https://docs.astral.sh/uv/guides/integration/pytorch/#__codelineno-16-9)
[](https://docs.astral.sh/uv/guides/integration/pytorch/#__codelineno-16-10)[tool.uv.sources]
[](https://docs.astral.sh/uv/guides/integration/pytorch/#__codelineno-16-11)torch=[
[](https://docs.astral.sh/uv/guides/integration/pytorch/#__codelineno-16-12){index="pytorch-cpu",marker="sys_platform != 'linux'"},
[](https://docs.astral.sh/uv/guides/integration/pytorch/#__codelineno-16-13){index="pytorch-cu128",marker="sys_platform == 'linux'"},
[](https://docs.astral.sh/uv/guides/integration/pytorch/#__codelineno-16-14)]
[](https://docs.astral.sh/uv/guides/integration/pytorch/#__codelineno-16-15)torchvision=[
[](https://docs.astral.sh/uv/guides/integration/pytorch/#__codelineno-16-16){index="pytorch-cpu",marker="sys_platform != 'linux'"},
[](https://docs.astral.sh/uv/guides/integration/pytorch/#__codelineno-16-17){index="pytorch-cu128",marker="sys_platform == 'linux'"},
[](https://docs.astral.sh/uv/guides/integration/pytorch/#__codelineno-16-18)]
[](https://docs.astral.sh/uv/guides/integration/pytorch/#__codelineno-16-19)
[](https://docs.astral.sh/uv/guides/integration/pytorch/#__codelineno-16-20)[[tool.uv.index]]
[](https://docs.astral.sh/uv/guides/integration/pytorch/#__codelineno-16-21)name="pytorch-cpu"
[](https://docs.astral.sh/uv/guides/integration/pytorch/#__codelineno-16-22)url="https://download.pytorch.org/whl/cpu"
[](https://docs.astral.sh/uv/guides/integration/pytorch/#__codelineno-16-23)explicit=true
[](https://docs.astral.sh/uv/guides/integration/pytorch/#__codelineno-16-24)
[](https://docs.astral.sh/uv/guides/integration/pytorch/#__codelineno-16-25)[[tool.uv.index]]
[](https://docs.astral.sh/uv/guides/integration/pytorch/#__codelineno-16-26)name="pytorch-cu128"
[](https://docs.astral.sh/uv/guides/integration/pytorch/#__codelineno-16-27)url="https://download.pytorch.org/whl/cu128"
[](https://docs.astral.sh/uv/guides/integration/pytorch/#__codelineno-16-28)explicit=true

```

Similarly, the following configuration would use PyTorch's AMD GPU builds on Linux, and CPU-only builds on Windows and macOS (by way of falling back to PyPI):
```
[](https://docs.astral.sh/uv/guides/integration/pytorch/#__codelineno-17-1)[project]
[](https://docs.astral.sh/uv/guides/integration/pytorch/#__codelineno-17-2)name="project"
[](https://docs.astral.sh/uv/guides/integration/pytorch/#__codelineno-17-3)version="0.1.0"
[](https://docs.astral.sh/uv/guides/integration/pytorch/#__codelineno-17-4)requires-python=">=3.14.0"
[](https://docs.astral.sh/uv/guides/integration/pytorch/#__codelineno-17-5)dependencies=[
[](https://docs.astral.sh/uv/guides/integration/pytorch/#__codelineno-17-6)"torch>=2.9.1",
[](https://docs.astral.sh/uv/guides/integration/pytorch/#__codelineno-17-7)"torchvision>=0.24.1",
[](https://docs.astral.sh/uv/guides/integration/pytorch/#__codelineno-17-8)"pytorch-triton-rocm>=3.5.1 ; sys_platform == 'linux'",
[](https://docs.astral.sh/uv/guides/integration/pytorch/#__codelineno-17-9)]
[](https://docs.astral.sh/uv/guides/integration/pytorch/#__codelineno-17-10)
[](https://docs.astral.sh/uv/guides/integration/pytorch/#__codelineno-17-11)[tool.uv.sources]
[](https://docs.astral.sh/uv/guides/integration/pytorch/#__codelineno-17-12)torch=[
[](https://docs.astral.sh/uv/guides/integration/pytorch/#__codelineno-17-13){index="pytorch-rocm",marker="sys_platform == 'linux'"},
[](https://docs.astral.sh/uv/guides/integration/pytorch/#__codelineno-17-14)]
[](https://docs.astral.sh/uv/guides/integration/pytorch/#__codelineno-17-15)torchvision=[
[](https://docs.astral.sh/uv/guides/integration/pytorch/#__codelineno-17-16){index="pytorch-rocm",marker="sys_platform == 'linux'"},
[](https://docs.astral.sh/uv/guides/integration/pytorch/#__codelineno-17-17)]
[](https://docs.astral.sh/uv/guides/integration/pytorch/#__codelineno-17-18)pytorch-triton-rocm=[
[](https://docs.astral.sh/uv/guides/integration/pytorch/#__codelineno-17-19){index="pytorch-rocm",marker="sys_platform == 'linux'"},
[](https://docs.astral.sh/uv/guides/integration/pytorch/#__codelineno-17-20)]
[](https://docs.astral.sh/uv/guides/integration/pytorch/#__codelineno-17-21)
[](https://docs.astral.sh/uv/guides/integration/pytorch/#__codelineno-17-22)[[tool.uv.index]]
[](https://docs.astral.sh/uv/guides/integration/pytorch/#__codelineno-17-23)name="pytorch-rocm"
[](https://docs.astral.sh/uv/guides/integration/pytorch/#__codelineno-17-24)url="https://download.pytorch.org/whl/rocm6.4"
[](https://docs.astral.sh/uv/guides/integration/pytorch/#__codelineno-17-25)explicit=true

```

Or, for Intel GPU builds:
```
[](https://docs.astral.sh/uv/guides/integration/pytorch/#__codelineno-18-1)[project]
[](https://docs.astral.sh/uv/guides/integration/pytorch/#__codelineno-18-2)name="project"
[](https://docs.astral.sh/uv/guides/integration/pytorch/#__codelineno-18-3)version="0.1.0"
[](https://docs.astral.sh/uv/guides/integration/pytorch/#__codelineno-18-4)requires-python=">=3.14.0"
[](https://docs.astral.sh/uv/guides/integration/pytorch/#__codelineno-18-5)dependencies=[
[](https://docs.astral.sh/uv/guides/integration/pytorch/#__codelineno-18-6)"torch>=2.9.1",
[](https://docs.astral.sh/uv/guides/integration/pytorch/#__codelineno-18-7)"torchvision>=0.24.1",
[](https://docs.astral.sh/uv/guides/integration/pytorch/#__codelineno-18-8)"pytorch-triton-xpu>=3.5.0 ; sys_platform == 'win32' or sys_platform == 'linux'",
[](https://docs.astral.sh/uv/guides/integration/pytorch/#__codelineno-18-9)]
[](https://docs.astral.sh/uv/guides/integration/pytorch/#__codelineno-18-10)
[](https://docs.astral.sh/uv/guides/integration/pytorch/#__codelineno-18-11)[tool.uv.sources]
[](https://docs.astral.sh/uv/guides/integration/pytorch/#__codelineno-18-12)torch=[
[](https://docs.astral.sh/uv/guides/integration/pytorch/#__codelineno-18-13){index="pytorch-xpu",marker="sys_platform == 'win32' or sys_platform == 'linux'"},
[](https://docs.astral.sh/uv/guides/integration/pytorch/#__codelineno-18-14)]
[](https://docs.astral.sh/uv/guides/integration/pytorch/#__codelineno-18-15)torchvision=[
[](https://docs.astral.sh/uv/guides/integration/pytorch/#__codelineno-18-16){index="pytorch-xpu",marker="sys_platform == 'win32' or sys_platform == 'linux'"},
[](https://docs.astral.sh/uv/guides/integration/pytorch/#__codelineno-18-17)]
[](https://docs.astral.sh/uv/guides/integration/pytorch/#__codelineno-18-18)pytorch-triton-xpu=[
[](https://docs.astral.sh/uv/guides/integration/pytorch/#__codelineno-18-19){index="pytorch-xpu",marker="sys_platform == 'win32' or sys_platform == 'linux'"},
[](https://docs.astral.sh/uv/guides/integration/pytorch/#__codelineno-18-20)]
[](https://docs.astral.sh/uv/guides/integration/pytorch/#__codelineno-18-21)
[](https://docs.astral.sh/uv/guides/integration/pytorch/#__codelineno-18-22)[[tool.uv.index]]
[](https://docs.astral.sh/uv/guides/integration/pytorch/#__codelineno-18-23)name="pytorch-xpu"
[](https://docs.astral.sh/uv/guides/integration/pytorch/#__codelineno-18-24)url="https://download.pytorch.org/whl/xpu"
[](https://docs.astral.sh/uv/guides/integration/pytorch/#__codelineno-18-25)explicit=true

```

## [Configuring accelerators with optional dependencies](https://docs.astral.sh/uv/guides/integration/pytorch/#configuring-accelerators-with-optional-dependencies)
In some cases, you may want to use CPU-only builds in some cases, but CUDA-enabled builds in others, with the choice toggled by a user-provided extra (e.g., `uv sync --extra cpu` vs. `uv sync --extra cu128`).
With `tool.uv.sources`, you can use extra markers to specify the desired index for each enabled extra. For example, the following configuration would use PyTorch's CPU-only for `uv sync --extra cpu` and CUDA-enabled builds for `uv sync --extra cu128`:
```
[](https://docs.astral.sh/uv/guides/integration/pytorch/#__codelineno-19-1)[project]
[](https://docs.astral.sh/uv/guides/integration/pytorch/#__codelineno-19-2)name="project"
[](https://docs.astral.sh/uv/guides/integration/pytorch/#__codelineno-19-3)version="0.1.0"
[](https://docs.astral.sh/uv/guides/integration/pytorch/#__codelineno-19-4)requires-python=">=3.14.0"
[](https://docs.astral.sh/uv/guides/integration/pytorch/#__codelineno-19-5)dependencies=[]
[](https://docs.astral.sh/uv/guides/integration/pytorch/#__codelineno-19-6)
[](https://docs.astral.sh/uv/guides/integration/pytorch/#__codelineno-19-7)[project.optional-dependencies]
[](https://docs.astral.sh/uv/guides/integration/pytorch/#__codelineno-19-8)cpu=[
[](https://docs.astral.sh/uv/guides/integration/pytorch/#__codelineno-19-9)"torch>=2.9.1",
[](https://docs.astral.sh/uv/guides/integration/pytorch/#__codelineno-19-10)"torchvision>=0.24.1",
[](https://docs.astral.sh/uv/guides/integration/pytorch/#__codelineno-19-11)]
[](https://docs.astral.sh/uv/guides/integration/pytorch/#__codelineno-19-12)cu128=[
[](https://docs.astral.sh/uv/guides/integration/pytorch/#__codelineno-19-13)"torch>=2.9.1",
[](https://docs.astral.sh/uv/guides/integration/pytorch/#__codelineno-19-14)"torchvision>=0.24.1",
[](https://docs.astral.sh/uv/guides/integration/pytorch/#__codelineno-19-15)]
[](https://docs.astral.sh/uv/guides/integration/pytorch/#__codelineno-19-16)
[](https://docs.astral.sh/uv/guides/integration/pytorch/#__codelineno-19-17)[tool.uv]
[](https://docs.astral.sh/uv/guides/integration/pytorch/#__codelineno-19-18)conflicts=[
[](https://docs.astral.sh/uv/guides/integration/pytorch/#__codelineno-19-19)[
[](https://docs.astral.sh/uv/guides/integration/pytorch/#__codelineno-19-20){extra="cpu"},
[](https://docs.astral.sh/uv/guides/integration/pytorch/#__codelineno-19-21){extra="cu128"},
[](https://docs.astral.sh/uv/guides/integration/pytorch/#__codelineno-19-22)],
[](https://docs.astral.sh/uv/guides/integration/pytorch/#__codelineno-19-23)]
[](https://docs.astral.sh/uv/guides/integration/pytorch/#__codelineno-19-24)
[](https://docs.astral.sh/uv/guides/integration/pytorch/#__codelineno-19-25)[tool.uv.sources]
[](https://docs.astral.sh/uv/guides/integration/pytorch/#__codelineno-19-26)torch=[
[](https://docs.astral.sh/uv/guides/integration/pytorch/#__codelineno-19-27){index="pytorch-cpu",extra="cpu"},
[](https://docs.astral.sh/uv/guides/integration/pytorch/#__codelineno-19-28){index="pytorch-cu128",extra="cu128"},
[](https://docs.astral.sh/uv/guides/integration/pytorch/#__codelineno-19-29)]
[](https://docs.astral.sh/uv/guides/integration/pytorch/#__codelineno-19-30)torchvision=[
[](https://docs.astral.sh/uv/guides/integration/pytorch/#__codelineno-19-31){index="pytorch-cpu",extra="cpu"},
[](https://docs.astral.sh/uv/guides/integration/pytorch/#__codelineno-19-32){index="pytorch-cu128",extra="cu128"},
[](https://docs.astral.sh/uv/guides/integration/pytorch/#__codelineno-19-33)]
[](https://docs.astral.sh/uv/guides/integration/pytorch/#__codelineno-19-34)
[](https://docs.astral.sh/uv/guides/integration/pytorch/#__codelineno-19-35)[[tool.uv.index]]
[](https://docs.astral.sh/uv/guides/integration/pytorch/#__codelineno-19-36)name="pytorch-cpu"
[](https://docs.astral.sh/uv/guides/integration/pytorch/#__codelineno-19-37)url="https://download.pytorch.org/whl/cpu"
[](https://docs.astral.sh/uv/guides/integration/pytorch/#__codelineno-19-38)explicit=true
[](https://docs.astral.sh/uv/guides/integration/pytorch/#__codelineno-19-39)
[](https://docs.astral.sh/uv/guides/integration/pytorch/#__codelineno-19-40)[[tool.uv.index]]
[](https://docs.astral.sh/uv/guides/integration/pytorch/#__codelineno-19-41)name="pytorch-cu128"
[](https://docs.astral.sh/uv/guides/integration/pytorch/#__codelineno-19-42)url="https://download.pytorch.org/whl/cu128"
[](https://docs.astral.sh/uv/guides/integration/pytorch/#__codelineno-19-43)explicit=true

```

Note
Since GPU-accelerated builds aren't available on macOS, the above configuration will fail to install on macOS when the `cu128` extra is enabled.
## [The `uv pip` interface](https://docs.astral.sh/uv/guides/integration/pytorch/#the-uv-pip-interface)
While the above examples are focused on uv's project interface (`uv lock`, `uv sync`, `uv run`, etc.), PyTorch can also be installed via the `uv pip` interface.
PyTorch itself offers a 
```
[](https://docs.astral.sh/uv/guides/integration/pytorch/#__codelineno-20-1)$
```

To use the same workflow with uv, replace `pip3` with `uv pip`:
```
[](https://docs.astral.sh/uv/guides/integration/pytorch/#__codelineno-21-1)$
```

## [Automatic backend selection](https://docs.astral.sh/uv/guides/integration/pytorch/#automatic-backend-selection)
uv supports automatic selection of the appropriate PyTorch index via the `--torch-backend=auto` command-line argument (or the `UV_TORCH_BACKEND=auto` environment variable), as in:
```
[](https://docs.astral.sh/uv/guides/integration/pytorch/#__codelineno-22-1)$# With a command-line argument.
[](https://docs.astral.sh/uv/guides/integration/pytorch/#__codelineno-22-2)$=auto
[](https://docs.astral.sh/uv/guides/integration/pytorch/#__codelineno-22-3)
[](https://docs.astral.sh/uv/guides/integration/pytorch/#__codelineno-22-4)$# With an environment variable.
[](https://docs.astral.sh/uv/guides/integration/pytorch/#__codelineno-22-5)$UV_TORCH_BACKEND=auto
```

When enabled, uv will query for the installed CUDA driver, AMD GPU versions, and Intel GPU presence, then use the most-compatible PyTorch index for all relevant packages (e.g., `torch`, `torchvision`, etc.). If no such GPU is found, uv will fall back to the CPU-only index. uv will continue to respect existing index configuration for any packages outside the PyTorch ecosystem.
You can also select a specific backend (e.g., CUDA 12.8) with `--torch-backend=cu126` (or `UV_TORCH_BACKEND=cu126`):
```
[](https://docs.astral.sh/uv/guides/integration/pytorch/#__codelineno-23-1)$# With a command-line argument.
[](https://docs.astral.sh/uv/guides/integration/pytorch/#__codelineno-23-2)$=cu126
[](https://docs.astral.sh/uv/guides/integration/pytorch/#__codelineno-23-3)
[](https://docs.astral.sh/uv/guides/integration/pytorch/#__codelineno-23-4)$# With an environment variable.
[](https://docs.astral.sh/uv/guides/integration/pytorch/#__codelineno-23-5)$UV_TORCH_BACKEND=cu128
```

At present, `--torch-backend` is only available in the `uv pip` interface.
December 3, 2025
